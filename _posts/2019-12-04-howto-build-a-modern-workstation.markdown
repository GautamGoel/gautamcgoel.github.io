---
layout: post
title:  "HOWTO: Build a modern workstation in 2020"
date:   2019-12-04 00:26:47 -0800
categories: hardware
---

Building a workstation is a rite of passage undertaken by many coders and machine learning researchers at some point in their careers. Many grad students in my department have also started building their own custom systems with beefy GPUs now that GPU computing has become the *de facto* platform for serious machine learning work; both my officemates built their own systems, for example. While building a workstation from components can be a lot of fun, it can also be a daunting task for first-timers. In this post I'll outline the main steps to contructing a powerful, silent workstation, from component selection to assembly to troubleshooting.


**Tl;dr: Look for CPUs with a high turbo clockspeed and at least six cores; I recommend either Intel Coffeelake or AMD Zen 2 chips, with the latter being a bit more powerful in 2020. Buy at least 16GB of RAM, with 32GB being my recommendation if doing machine learning. When buying RAM, buy at least 2 sticks and make sure to insert them into the appropriate DIMM slots so as to saturate your memory bandwidth. You can mostly ignore RAM speed and CAS latencies. Don't overspend money on fancy motherboards and power supplies; instead spend that money on a better CPU or GPUs. Make sure to buy an SSD instead of a traditional HDD; any modern SSD should be fine. When buying a GPU, remember that a single high-powered GPU will usually be cheaper and more powerful than two midrange GPUs; memory bandwidth is the key metric to look at when evaluating your GPU options, followed by number of GPU cores and the amount of RAM on the card. In 2020, Nvidia GPUs are generally a bit ahead of AMD GPUs, especially when it comes to machine learning. If using multiple GPUs, invest in a CPU/chipset with enough PCI lanes to keep your GPUs fed. Noctua fans and heatsinks are fantastic if you want a super-quiet build.**

## Selecting components
The necessary components to construct a workstation are a CPU, a motherboard, 1-4 sticks of RAM, a solid-state drive (SSD), a case, a power supply, CPU cooler and case fans, and (optionally) 1-2 GPUs. Let's consider each component one by one.

**CPU**: This is one of the most important components of your build. There are three key variables to consider when selecting a processor: *clockspeed*, *architecture*, and *core count*.  Modern CPUs consist of several distinct *CPU cores*, each which can independently perform work; this work is multiplexed across billions of CPU cycles. Every cycle, a CPU core executes one or more instructions (some instructions take multiple cycles to execute). How many cycles occur per second is determined by the CPU *clockspeed*; a 4.6 GHz clockepeed means that your CPU core runs 4.6 billion cycles per second. How many concurrent instructions a CPU core can execute, and how powerful those instructions are, is determined by the *architecture*; and the number of cores a CPU has is called its *core count*. Keep in mind that processors usually have two clockspeeds: the *base* frequency (often about 3.5 - 4.5 GHz) and the *boost* or *turbo* frequency (often in the 4.5-5 GHz range). CPUs will usually run at the base frequency, but if you are really taxing them they will jump into their turbo frequency, provided they are provided with sufficient cooling to dissapate the resulting heat. Also keep in mind that most software is *single-threaded*, meaning it is designed to run on a single CPU core; switching to a CPU with more cores will provide no benefit to such software, since it will be unable to take advantage of the extra cores. **You should aim to buy CPUs with high turbo clockspeeds, since this makes the single biggest noticeable difference for typical workloads; after that, you should aim to buy a CPU with a lot of cores and a recent microarchitecture.**

Depending on your needs, you may also wish to consider some additional factors when deciding which CPU to buy. First, does the CPU offer integrated graphics? If not, you will have to buy a GPU separately, which will add to the price of your build. Second, how many PCI lanes does your CPU support? Recent Intel CPUs offer 16 PCI 3.0 lanes, with additional lanes provided by the chipset. AMD does much better here; the latest AMD Zen 2 chips offer 24 PCI 4.0 lanes, with additional lanes provided by the chipset. Hence AMD may be a better choice if you need many PCI lanes with lots of bandwidth, which is exactly what you want if you are going to be using multiple bandwidth-hungry GPUs (if you are planning to use only a single GPU, then either chipset is probably fine, since a single GPU can use at most 16 PCI lanes). Lastly, some CPUs support *overclocking*. This is when you run the processor at a slightly faster speed than it was designed to be run, allowing it to execute more instructions per second; a 10-15% overclock is typical. Intel processors only support overclocking if they have the suffix 'K"; AMD parts with the suffix 'X' also support overclocking. Usually you pay a premium to buy an overclocked chip, and will also need a good motherboard to support the increased power draw of an overclocked CPU; the advantage is that you get a speedup "for free", i.e. CPU-bound software will run a bit faster without any special tuning. **Mid-range recommendations: Intel i5 9600K, Intel i7 9700K or AMD 3600X/3800X. High-end recommendations: AMD 3950X or AMD Threadripper.**

**GPUs**: You may want to consider investing in a graphics processing unit (GPU) if you intend to do heavy graphical work (video editing, animation, etc.) or high performance computing/scientific computing (machine learning, physics simulations, etc.). In particular, GPUs have now become a standard tool for training and inference in deep learning models. Note that if your CPU does not have integrated graphics you will need a GPU just to get any video output. Almost all Intel Core processors have integrated graphics, but Intel Xeon processors and most AMD processors do not feature integrated graphics.
If all you need is video output to make up for your CPU's lack of integrated graphics, a cheap video card like the Nvidia 1030 should work fine (note that AMD cards generally have better open-source driver support and may be better supported on Linux). **As of 2019 Nvidia cards have better software support for deep learning workflows than AMD cards, and in general offer better performance overall. The key metric to look at when buying a GPU is *memory bandwidth*, which roughly measures how quickly the GPU cores can access data on the GPU RAM. You should also look at how many GPU cores a GPU has, and how much RAM is on the card. I strongly advise investing in one very powerful GPU instead of two mid-tier GPUs, especially if you have modest computing needs or are just getting started with GPU computing.** This will give much better bang for your buck; when multiple GPUs are present, they waste time trying to access data stored on in the memory of other GPUs, so you don't quite get twice the power provided by a single GPU. This problem is avoided when a single GPU is present, since all the data is stored in the same address space. Of course, if you really need even more performance it may be appropriate to invest in multiple high-end cards. **Mid-range recommendation: Nvidia 2070. High-end recommendations: Nvidia 2080, 2080 Ti, or Titan.**

**Motherboard**: Honestly, people make way too big a deal about motherboards; **I would strongly recommend investing in your CPU and GPUs instead of spending a lot of money on a fancy motherboard.** There are two things to look for when selecting a motherboard. First, how beefy is the Voltage Regulator Module (VRM)? The VRM is the part of the motherboard that feeds power to your processor; loosely speaking, the more "phases" the VRM has, the better able it is to smooth our irregularities in the power fed into the CPU. This usually only becomes an issue when overclocking; if you are not planning on overlocking, or only planning a mild overclok, you probably don't need to worry about the VRM. The second factor to consider is what ports and PCI lanes are supported by the motherboard; this is determined by the *chipset* associated with your motherboard; for Intel the best chipset at the moment is Z390, whereas AMD's top chipset is X570. I recommend buying a motherboard from a respected manufacturer; the big players are Asus, MSI, Gigabyte, and Asrock.


**RAM**: A modern workstation should have at least 8GB of RAM, with 16GB preferred. There are a few things to keep in mind when selecting RAM. First, you usually want to get at least 2 sticks of RAM instead of one. This is because modern CPUs generally have at least two channels to access RAM (Intel Core processors and AMD Ryzen processors have two; Intel Xeon, Intel Core-X, AMD Epyc, and AMD Threadripper processors generally come with at least 4). By having two sticks of RAM you are thus able to use both channels and achieve full memory bandwidth; if you use only one stick, you are stuck to a single channel with half the memory bandwidth. Thus, all else being equal, it is better to have two 8GB sticks of RAM then one 16GB stick. Another thing to keep in mind is the size of the workloads you intend to run. If you intend to do a lot of video editing or analyze large data sets, then 32GB or even 64GB might be appropriate; for most other users, 16GB should be more than enough (I would recommend at least 32 GB for machine learning workloads). Don't worry too much about RAM speed or CAS latency; these generally have negligible impact on real workloads. Most users will be perfectly fine with RAM clocked at 2400 Mhz or 2667 Mhz (or higher). Make sure to buy the right generation of RAM - modern processors usually use DDR4 RAM, not the older DDR3 RAM.

**SSD** Let's get one thing out of the way: if you are building a workstation in 2020, it should have an solid-state drive (SSD) instead of a traditional, spinning-metal-plate Hard Disk Drive (HDD). Going from an HDD to an SSD is probably the single most effective way to upgrade an older, sluggish system. There are two different interfaces used by SSDs. Some SSDs use the old SATA interface, which is the same interface used by traditional hard drives. On the other hand, more recent SSDs tend to use the newer Non-Volatile Memory Express (NVMe) standard, which was specifically designed for solid-state storage. The advantage of SATA drives is that they are typically a bit cheaper; the disadvantage is that their bandwidth is limited to about 600 MB/s, whereas a good NVMe drive can easily have bandwidth of 2-3 GB/s. (Here I am stating bandwidth in terms of serial read speeds; writes and random acess reads/writes are usually slower). I don't think it matters too much whch SSD you go with; pretty much any decent SSD will trounce any HDD. I don't use a lot of storage, so 256GB is more than enough for me; 512Gb or 1TB might be more appropriate for you, depending on your needs. I chose the **256GB Samsung 970 Evo NVMe SSD**; at the time of writing, the 512GB version is strangely cheaper than the 256GB version, so you may as well buy the 512GB one.

**Case** I don't have much to say about cases; this is largely a function of your personal aesthetic. Obviously, you want a case that's large enough to house all your components - most cases will explicitly list what size GPUs they can accomodate, so make sure yours will fit before you go out and buy a case. Also, try to select a case with good airlow; you want one with plenty of vents so your case fans can easily flush out hot air. On the basis of sveeral glowing reviews, I ended up picking the **Fractal Design Meshify C** and I have to say, I really like this case. It is relatively compact, has easy to use veclro straps for cable management, and looks fantastic.

**Power supply**
Like motherboards, people tend to overspend on power supplies; good power supplies can be found for $50, and there's rarely a need to spend more than $100-$200. The role of the power supply is to take wall current from your power outlet and transform it into a form suitable to power your motherboard and GPUs. Power supplies are rated to support a certain amount of load; a 500-watt power supply can support at most 500 watts of concurrent energy use. Your CPU and motherboard together will generally draw about 100W - 200W; a high-powered GPU can draw up to about 200-250W at full load. This means that you almost certainly don't need a power supply rated above 600 watts, especially if you're only using a single GPU; in particular, there's no need to invest in a fancy 1 KW power supply. I would recommend going with a trusted brand like SeaSonic, EVGA, Corsair, Thermaltake, etc; avoid cheap "no-name" power supplies. I went with the **SeaSonic 600W Prime Titanium** PSU, mainly because it was fanless and hence completely silent.


**CPU cooler** All AMD CPUs and all locked Intel CPUs come with an included CPU heatsink and fan. The AMD ones are usually decent, but Intel has a reputation for including wimpy CPU coolers which struggle to dissipate heat and can cause your CPU to throttle. I decided to buy a nice Noctua heatsink with fan (**Noctua NH-L9x65**), which conveniently supports both Intel and AMD sockets. I'm very happy with my choice; the fan is whisper-quiet.


**Case fans** Most cases will ship with at least 1-2 case fans, which help ventillate your workstation and flush out the hot air generated by the CPU and GPU's. Usually these are fine, but keep in mind that the case fans that come with your case are usually cheap fans and can be needlessly noisy. I decided to spring for some fancy high-end Noctua case fans since I wanted a silent build.


## Assembling the system



**Troubleshooting.** If your system isn't booting, there are a few things you should check first. Are the RAM sticks properly situated in the DIMM slots? Make sure they are fully inserted - usually they will click into place when properly seated. Second, check that the power supply cables are properly attached to the motherboard. Modern motherboards will often have an LED that lights up when the system has power - if that LED isn't turning on when you boot up, you might have a power issue. Note that CPUs, GPUs, RAM, and SSDS rarely have hardware failures; I've never heard of one of these components coming defective out of the box, though I have heard of faulty motherboards. If you are really sure that you have a defective part, look at the motherboard first.
